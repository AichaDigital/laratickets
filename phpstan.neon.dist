parameters:
    level: 6
    paths:
        - src
        - database/migrations
    tmpDir: build/phpstan
    checkOctaneCompatibility: true
    checkModelProperties: true
    reportUnmatchedIgnoredErrors: false

    excludePaths:
        - config/*

    ignoreErrors:
        # Ignore stub migration files type issues
        - '#Offset .* on .* in migration always exists and is not nullable#'

        # Ignore HasFactory generic type - not needed in practice
        - '#Class .* uses generic trait Illuminate\\Database\\Eloquent\\Factories\\HasFactory but does not specify its types: TFactory#'

        # Ignore covariance issues with Eloquent relations - known PHPStan limitation
        # These occur because PHPStan expects exact class match but Eloquent uses $this
        - '#should return Illuminate\\Database\\Eloquent\\Relations\\(BelongsTo|HasMany)<.+> but returns Illuminate\\Database\\Eloquent\\Relations\\(BelongsTo|HasMany)<.+\$this\(.+\)>#'

        # Ignore belongsTo template type in HasUserRelation trait
        # The User model class is resolved dynamically from config('laratickets.user.model')
        # PHPStan cannot resolve template types for dynamic class-string values
        # See: https://phpstan.org/blog/solving-phpstan-error-unable-to-resolve-template-type
        -
            message: '#^Unable to resolve the template type TRelatedModel in call to method Illuminate\\Database\\Eloquent\\Model::belongsTo\(\)$#'
            path: src/Concerns/HasUserRelation.php

        # Ignore deprecated Request::get() - will be addressed in future refactor
        -
            message: '#^Call to deprecated method get\(\) of class Illuminate\\Http\\Request#'
            path: src/Http/Controllers/Api/TicketController.php
